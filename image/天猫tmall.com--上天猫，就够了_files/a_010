window.MLoginTimer=0;window.MLoginShow=0;KISSY.add("mui/minilogin/index",function(e,o,n){var i=function(e){var o=location.hostname.split(".");return o.splice(o.length-e>0?o.length-e:0,e).join(".")}(2),t=location.hostname.indexOf(".net")>=0||location.hostname.indexOf(".com.hk")>=0,a=t?"daily.taobao.net":"taobao.com",r=t?"daily.tmall.net":"tmall.com",l=t?"daily.tmall.com.hk":"tmall.hk",c,m="assets_css=3.0.5/login_pc.css",d="//login."+a+"/member/login.jhtml?style=miniall&newMini2=true&enup=true&from=tmall&allp="+escape(m);var s=window.location.protocol;var w={check:true,needRedirect:false,sub:false,proxy:{tmall:s+"//vip."+r+"/miniLoginProxy.htm",hk:s+"//www."+l+"/loginproxy.htm",yao:s+"//yao.95095.com/go/rgn/95095/loginproxy.php",etao:s+"//vip.daily.tmall.net/miniLoginProxy.htm"}};function f(e){var o=document.createElement("a");o.href=e;return o.hostname===location.hostname}var u={show:function(o,n){window.goldlog&&window.goldlog.send("//log.mmstat.com/tmallmember.9.2",{});u.Analytics.MLstar=new Date*1;var i=this;if(typeof o!=="function"){n=o;o=null}n=e.merge(w,n);var t=new Date;t.setDate(t.getDate()-1);document.cookie="cookie2=;expires="+t.toGMTString()+";path=/;domain=.tmall.com";if(n.check===false){this._show(o,n)}else{this._check(function(t){u.Analytics.MLcheckStar=new Date*1;if(t){if(window.MLoginShow<=1&&!e.UA.mobile){TB&&TB.Global&&TB.Global.updateLoginInfo()}o&&o();window.MLoginShow+=1}else{i._show(o,n)}},n)}},_checkPage:function(){return window.TB&&window.TB.userInfo&&window.TB.userInfo.isLogin},_check:function(o,n){u.Analytics.MLcheckStar=new Date*1;var i=this;var t=n.checkTimeout||5;var a=false,l=e.later(function(){if(!a){o(i._checkPage())}l&&l.cancel()},t*1e3);if(n&&n.checkApi&&n.checkApi.indexOf(".tmall.")==-1){n.checkApi=undefined}return e.io({type:"get",url:n.checkApi?n.checkApi:"//miaoxin."+r+"/member/user_login_info2.do",success:function(e){u.Analytics.MLcheckEnd=new Date*1;e=e||{};if(e.status==1111){a=true;o(i._checkPage());return}a=true;o(e.login)},error:function(){a=true;o(i._checkPage())},timeout:t,dataType:"jsonp",charset:"utf-8",cache:false,headers:{"X-Requested-With":false}})},_show:function(n,t){u.Analytics.MLshowStar=new Date*1;window.MLoginTimer+=1;if(!!t.insert){window.MLoginTimer=0}if(window.MLoginTimer>1){return}var r,l=d,m="",s=window.location.hostname,w="";if(!!e.UA.mobile){m=window.location.href;l="//login."+a+"/member/login.jhtml?redirectURL="+encodeURIComponent(m);window.location.href=l;window.MLoginTimer=0;return false}if(t.needRedirect){var h=t.redirectUrl?t.redirectUrl:location.href.split("#")[0];l+="&full_redirect=true&tpl_redirect_url="+encodeURIComponent(h)}else{r="g_tml_callbak"+(new Date).getTime();window[r]=function(){var e=window.TB||{};c&&c.hide();e&&e.Global&&e.Global.updateLoginInfo();window.MLoginTimer=0;window.MLoginShow+=1;n&&n.apply(this,arguments);try{delete window[r]}catch(o){}};if(t["proxyURL"]){m+=t["proxyURL"]}else if(s.indexOf(".hk")>=0){m+=t["proxy"]["hk"]}else if(s.indexOf("95095.com")>=0){m+=t["proxy"]["yao"]}else if(s.indexOf("95095.daily.etao.net")>=0){m+=t["proxy"]["etao"]}else{m+=t["proxy"]["tmall"]}m+=(m.indexOf("?")>0?"&":"?")+"callback="+r;if(!f(m)&&document.domain!==i){document.domain=i}if(f(m)&&document.domain===location.hostname){m+="&nsdomain=true"}l+="&full_redirect=false&tpl_redirect_url="+encodeURIComponent(m)}if(t.sub){l+="&sub=true"}if(window.g_config&&window.g_config.moduleTimeStamp&&window.g_config.moduleTimeStamp.minilogin){l+="&t="+window.g_config.moduleTimeStamp.minilogin}w='<iframe class="j_minilogin_iframe" style="background: rgb(250, 250, 250);" width="350" scrolling="no" height="400" frameborder="no" src="'+l+'"></iframe>';if(!!t.insert){e.all(t.insert).append(w);return}c=new o({width:350,height:436,bodyContent:w,mask:true,showCat:true,zIndex:999999,align:{points:["cc","cc"]}});c.render();c.show();var g=e.version.indexOf("1.3")>=0,p=e.all(g?c.__attrVals.el:c.$el),y=g?".mui-stdmod-body":".mui-dialog-body",k=g?".mui-ext-close":".mui-dialog-close",_=p.all(".j_minilogin_iframe");_.parent(y).style("background-color","#FAFAFA");u.Analytics.MLshowEnd=new Date*1;p.all(k).on("click",function(){t.closeCallback&&t.closeCallback();window.MLoginTimer=0;c.destroy()});_.on("load",function(){u.Analytics.MLloaded=new Date*1;u.sendTrack()})},Analytics:{},sendTrack:function(){if(!window.performance||window.performance&&!window.performance.getEntriesByType){return}var e;for(var o=0,n=window.performance.getEntriesByType("resource");o<n.length;o++){if(n[o]["initiatorType"]=="iframe"&&n[o]["name"].indexOf("https://login.taobao.com/member/login.jhtml")>=0){e=n[o];break}}if(!e){return}var i=[];for(var t in e){i.push(t+"="+(t=="name"?"//login.taobao.com":e[t]))}for(var t in u.Analytics){i.push(t+"="+u.Analytics[t])}i.push("MLtype=minilogin");var a=["[uhttp://login.tmall.com/track/0.2.0/]","[r10]"].join(""),r=document.cookie.match(/_nk_\=([^\;]*); /),l=r&&r[1]||"",c="//gm.mmstat.com/ued.1.1.2?type=9&id=jstracker&v=0.02&nick="+encodeURIComponent(l)+"&msg="+a+escape(i.join("&"));(new Image).src=c}};return u},{requires:["mui/overlay/dialog","io"]});KISSY.add("mui/overlay/dialog",function(e,t){function i(t){var n=this;n.config=e.merge(i.Config,t);n.config.elCls=n.config.elCls||"";n.config.elCls+=n.config.skin?" mui-dialog-"+n.config.skin:"";if(n.config.mask){n.config.elCls+=" mui-dialog-hasmask"}i.superclass.constructor.call(this,n.config);var s=true;function o(){var t=n.get("el"),i=e.UA.ie<8?"style='height:expression(this.parentNode.clientHeight);'":"";t.append("<div class='mui-dialog-skin' "+i+"></div>"+(n.config.showCat?"<i class='mui-dialog-cat'></i>":""));s=false}n.on("afterRenderUI",function(){o()});if(n.get("initRender")){n.render()}}i.Config={prefixCls:"mui-",showCat:true,zIndex:99999,initRender:false};e.extend(i,t.Dialog);e.augment(i,{setBodyContent:function(e){var t=this;t.set("bodyContent",e);t.render()},setHeaderContent:function(e){var t=this;t.set("headerContent",e);t.render()},setFooterContent:function(e){var t=this;t.set("footerContent",e);t.render()}});if(e.version.match(/^1\.[123]/)){e.getScript(location.protocol+"//g.alicdn.com/mui/overlay/1.0.6/overlay.css")}return i},{requires:["overlay","mui/overlay/overlay.css","mui/button/btn.css","mui/button/btn-tb.css","mui/msg/msg.css"]});KISSY.add("mui/storage/index",function(e,t,n,r,o,a){var i={};var c=0;var s=function(t){var n=this;t=t||{};t.token=+new Date+o.getRndStr(8);var a=t.proxy||r.PROXY;switch(a){case"tmall":a=r.PROXY_TMALL;break;case"taobao":a=r.PROXY_TAOBAO;break;case"common":a=r.PROXY;break}a=o.fm("{0}{1}{2}={3}",a,a.indexOf("?")>-1?"&":"?",r.XD_TOKEN,t.token);t.proxy=a;t.prefix=t.prefix||"";n._opt=e.merge(i,t);n.init()};e.augment(s,{init:function(){var t=this;t.setConf(r.K.CALLBACK_LIST,{});t.setConf(r.K.CACHED_ACTION_LIST,[]);t.setConf(r.K.PROXY_READY,false);var n=t.getConf(r.K.CALLBACK_LIST);var i=t.getConf(r.K.CACHED_ACTION_LIST);var s=document.createElement("iframe");var u=s.style;u.display="none";var f=-1;function d(u){var f=new a({target:s.contentWindow,token:t.getConf(r.K.TOKEN),iframeTimeout:u,timeout:t.getConf(r.K.XD_TIMEOUT),receive:function(e){var t=n[e.c];if(t){t(e.v);try{delete n[e.c]}catch(r){}}}});t.setConf(r.K.XD,f);function d(){t.setConf(r.K.PROXY_READY,true);e.each(i,function(e){f.send(e,"*")});t.setConf(r.K.CACHED_ACTION_LIST,[]);var n=t.getConf(r.K.ONLOAD);n&&n()}if(u){d()}else{if(window.postMessage){var l=false;var m=0;var _=setInterval(function(){++m;o.log(m,l);if(l||m>30){clearInterval(_);d();return}var e="token"+ ++c;n[e]=function(e){l=!!e};f.send({m:"connect",c:e},"*",true)},50)}else{setTimeout(d,600)}}}f=setTimeout(function(){f=0;d(true)},t.getConf(r.K.IFRAME_TIMEOUT)||r.TIMEOUT_STORAGE);function l(e){o.log("storage proxy loaded");clearTimeout(f);if(!f){return}d(false)}if(s.attachEvent){s.attachEvent("onload",l)}else{s.onload=l}s.src=t.getConf(r.K.PROXY);document.body.appendChild(s)},send:function(t){var n=this;var o=n.getConf(r.K.CALLBACK_LIST);var a=n.getConf(r.K.CACHED_ACTION_LIST);var i=n.getConf(r.K.PROXY_READY);var s=n.getConf(r.K.PREFIX);t.p=s;if(e.isFunction(t.success)){var u="token"+ ++c;t.c=u;o[u]=t.success;try{delete t.success}catch(f){}}if(!i){a.push(t);return}var d=n.getConf(r.K.XD);d&&d.send(t)},get:function(e){e=e||{};e.m="get";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_GET)},set:function(e){e=e||{};e.m="set";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_SET)},remove:function(e){e=e||{};e.m="remove";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_RM)},clear:function(e){e=e||{};e.m="clear";this.send(e);Math.random()<r.SAM_PV&&o.sendLog(r.ARR.ST_CL)},getConf:function(e){return this._opt[e]},setConf:function(e,t){this._opt[e]=t}});return s},{requires:["event","json","mui/storage/conf","mui/storage/util","mui/storage/xd"]});KISSY.add("mui/storage/conf",function(){var e=location.href.indexOf("if-debug=1")>-1;var t=location.href.indexOf("if-debug-log=1")>-1;var r="//gm.mmstat.com";var n="//log.mmstat.com/ued.1.1.2?type=9&_gm:id=storage&v=1.1";var a={DEBUG:e,DEBUG_LOG:t,SAM_PV:1/1e3,TIMEOUT_STORAGE:3*1e3,PROXY:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",PROXY_TMALL:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",PROXY_TAOBAO:e?"//pre-wormhole.tmall.com/wow/tmbase/act/storage-proxy-3-0-4":"//pages.tmall.com/wow/tmbase/act/storage-proxy-3-0-4",XD_TOKEN:"__mui_xd_token",UID_FROM:"__mui_xd_from",UID_TO:"__mui_xd_to",M:{G:n+"&t=g",P:n+"&t=p"},ARR:{ST_SET:r+"/tmallbrand.999.5",ST_GET:r+"/tmallbrand.999.6",ST_RM:r+"/tmallbrand.999.7",ST_CL:r+"/tmallbrand.999.8",ST_TMO:r+"/tmallbrand.999.10"},K:{ONLOAD:"onload",PROXY:"proxy",PREFIX:"prefix",XD_TIMEOUT:"xdTimeout",IFRAME_TIMEOUT:"iframeTimeout",IFRAME:"iframe",TOKEN:"token",XD:"xd",CALLBACK_LIST:"callbackList",CACHED_ACTION_LIST:"cachedActionList",PROXY_READY:"proxyReady"}};return a});KISSY.add("mui/storage/util",function(e,t){var n={log:function(){if(!t.DEBUG_LOG){return}if(window.console&&window.console.log&&window.console.log.apply){window.console.log.apply(window.console,arguments)}},fm:function(){if(arguments.length==0){return""}else if(arguments.length==1){return arguments[0]}var e=arguments[0],t;for(t=1;t<arguments.length;++t){var n=new RegExp("\\{"+(t-1)+"\\}","g");e=e.replace(n,arguments[t])}return e}};var r=n;r.sendLog=function(e){r.send(r.fm(t.M.G,encodeURIComponent(location.href)));r.send(e)};r.send=function(e){if(!e){return}var t="__st_"+ +new Date+Math.random();var n=new Image;window[t]=n;n.src=r.fm("{0}{1}r{2}=1",e,e.indexOf("?")>-1?"&":"?",+new Date);n.onload=function(){window[t]=null}};var o="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";r.getRndStr=function(e){var t=[];var n=o.length,r;for(var a=0;a<e;++a){r=o.charAt(Math.floor(Math.random()*n));t.push(r)}return t.join("")};return r},{requires:["mui/storage/conf"]});KISSY.add("mui/storage/xd",function(e,t,n,r,a,o){var i=0;var s=document.domain;var u="receive";var c="token";var f="target";var m="timeout";var d="iframeTimeout";var l=10;var v=10;var g=3*1e3;var _="_name_store_";var p=window;var h=p.postMessage;var O={};var T=[];function w(){if(h){if(p.addEventListener){addEventListener("message",A,false)}else if(p.attachEvent){attachEvent("onmessage",A)}}else{I.onMessage(A)}}var I={uid:0,hid:-1,q:[],tm:0,postMessage:function(e,t,n){var r=++I.uid;var a=I.q;var i={name:+new Date+""+r+"^"+s+"&"+t,uid:r,target:e};a.push(i);if(!I.tm){I.tm=setInterval(function(){var e=I.q;if(e.length===0||e[0].uid===I.hid){return}var t=e[0];I.hid=t.uid;o.setItem(_,name)},v)}},onMessage:function(e){var t="";var n=/^(\d+?)\^(.+?)&(.*?)$/;function r(){var r=o.getItem(_);if(r!==t){I.q.shift();t=r;var a=n.exec(r);if(!a){return}var i={origin:a[2],data:a[3]};e&&e(i)}}setInterval(r,l)}};function A(t){var a={};try{a=n.parse(t.data)}catch(o){return}var i=a[r.XD_TOKEN];e.each(T,function(e){if(i===e.get(c)&&r.UID_FROM in a&&r.UID_TO in a){var t=a[r.UID_TO];if(t){var n=O[t];clearTimeout(n);O[t]=0;if(!n){return}}e.get(u)(a)}})}w();function E(e){var t=this;t._opt=e;T.push(t)}e.augment(E,{send:function(t,o,u){if(!e.isObject(t)){return}var l=this;var v=l.get(f);var _=l.get(m)||g;var p=++i;o=o||"*";t[r.XD_TOKEN]=l.get(c);t[r.UID_TO]=t[r.UID_FROM]||0;t[r.UID_FROM]=u?0:p;var T=n.stringify(t);function w(){h&&I.q.shift();var e={};e.origin="*";var a={};a.c=t.c||"";a[r.XD_TOKEN]=t[r.XD_TOKEN]||"";a[r.UID_FROM]=0;a[r.UID_TO]=0;e.data=n.stringify(a);A(e)}if(!u){O[p]=setTimeout(function(){a.log(s,"timeout",p);O[p]=0;w();Math.random()<r.SAM_PV&&a.sendLog(r.ARR.ST_TMO)},_)}if(l.get(d)){w()}else{if(h){v.postMessage(T,o)}else{I.postMessage(v,T,o)}}},get:function(e){return this._opt[e]},set:function(e,t){this._opt[e]=t}});return E},{requires:["event","json","mui/storage/conf","mui/storage/util","mui/storage/name"]});KISSY.add("mui/storage/name",function(e){var t=window;var n="nameStorage:";var r=/^([^=]+)(?:=(.*))?$/;var o="?";var a="=";var i="&";var c=encodeURIComponent;var u=decodeURIComponent;var f={};var s;var d={};var l={};(function g(e){if(e&&e.indexOf(n)===0){var t=e.split(/[:?]/);t.shift();s=u(t.shift())||"";var o=t.join("");var a=o.split(i);for(var c=0,d,l,m,v=a.length;c<v;c++){d=a[c].match(r);if(!d||!d[1]){continue}l=u(d[1]);m=u(d[2])||"";f[l]=m}}else{s=e||""}})(t.name);l.setItem=function(e,t){if(!e||"undefined"===typeof t){return}f[e]=String(t);m()};l.getItem=function(e){return f.hasOwnProperty(e)?f[e]:null};l.removeItem=function(e){if(!f.hasOwnProperty(e)){return}f[e]=null;delete f[e];m()};l.clear=function(){f={};m()};l.valueOf=function(){return f};l.toString=function(){var e=t.name;return e.indexOf(n)===0?e:n+e};function m(){var e=[];var r=true;var u;for(var d in f){if(!f.hasOwnProperty(d)){continue}r=false;u=f[d]||"";e.push(c(d)+a+c(u))}t.name=r?s:n+c(s)+o+e.join(i)}function v(e,t,n){if(!e){return}if(e.addEventListener){e.addEventListener(t,n,false)}else if(e.attachEvent){e.attachEvent("on"+t,function(t){n.call(e,t)})}}v(t,"beforeunload",function(){m()});return l});